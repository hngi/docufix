<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="https://fonts.googleapis.com/css?family=Pacifico|Ubuntu&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
    <title>Docufix | Compare Text</title>

    <style>
  *{
    margin:0px;
    padding: 0px;
    box-sizing: border-box;
}

body{
    padding: 60px 60px 90px 30px;
    background-color: #EEF3F3;
    font-family: 'Ubuntu', sans-serif;
}

#file-text{
    display: flex;
    justify-content: center;
    align-items: center;
    font-weight: bold;;
}
    #file{
        display: flex;;
        border-right: 2px solid black;
        padding: 20px 30px 20px 0px;
        align-items: center;
    }
    #text{
        display: flex;
        padding: 20px 0 20px 30px;
        align-items: center;;
    }

#text-compare{
    display: flex;
    padding: 30px 60px;
    justify-content: space-between;
}
    #text-1{
        width: 44%;
    }
        .labels{
            display: flex;
            padding: 10px 0px 10px 30px;
            width: 100%;
            background-color: #000000;
            color: white;
            margin-bottom: -7px;
            font-weight: bold;
            
        }
            .labels img{
                margin-right: 10px;
            }
    #arrow{
        align-self: center;
        
    }
    #text-2{
        width: 44%;
    }

    .input-txt{
        margin-top: -15px;
        width: 100%;
        height: 400px;
        padding: 15px 30px;
   
    }

    #button{
        display: flex;
        justify-content: center;
        text-align: center;
        margin-top: 30px;
    }

        button{
            border-radius: 20px;
            background-color: #000000;
            color: #ffffff;
            padding: 15px 30px;
            border: none;
            outline: none;
            cursor: pointer;
        }
            button:hover{
                font-weight: bold;
                background-color: #221e1e;
            }
            button img{
            width: 16.5px;
            height: 16.5px;
            vertical-align: middle;
            margin-right: 10px;
            }



@media screen and (max-width: 600px){

    body{
        padding: 60px 30px;
        text-align: center;
    }

    #main-text{
        margin-bottom: 25px;
        font-size: 24px;
    }
    #file-text{
        font-size: 18px;
    }

    #text-compare{
        flex-direction: column;
        padding: 30px 10px 10px 10px ;
    }
    #text-2, #text-1{
        width: 100%;
    }

    button{
        width: 70%;
        font-size: 15px;
    }

}

    </style>
</head>
<body>
    <h1 id="main-text">Compare two documents</h1>

    <div id="file-text">
        <div id="file">
            <img class="top-icons" src="https://res.cloudinary.com/dtbjhs8a6/image/upload/v1571193844/samples/figma%20career-list/lario/xisa8mltboqmepbzjqks.png">
            <span class="compare">File</span>
        </div>

        <div id="text">
            <img class="top-icons" src="https://res.cloudinary.com/dtbjhs8a6/image/upload/v1571193193/samples/figma%20career-list/lario/slpij76xxh4f7bpixbr5.png">
            <span class="compare">Text</span>
        </div>
        
    </div>
    
    <form id="uploadForm" method="POST" enctype="multipart/form-data">
        <!-- {% csrf_token %} -->
        <label for="upload1">First File</label>
        <input
            id="upload1"
            type="file"
            name="file1"
 
        />


        <label for="upload2">Second File</label>
        <input
            id="upload2"
            type="file"
            name="file2"
   
        />
        <input id="uploadBtn" type="submit" value="submit">

    </form>
    <section id="text-compare">
        <div id="text-1">
            <label for="text" class="two-text">
                <div class="labels" >
                    <img class="white-txt" src="https://res.cloudinary.com/dtbjhs8a6/image/upload/v1571194266/samples/figma%20career-list/lario/ct8pi1qsjgonxsa7zdyn.png">
                    <span id="white-txt" class="compare">Text</span>
                </div>
            </label> <br>
            <textarea placeholder="Write your text here" id="input1" class="input-txt"></textarea>
        </div>
        <div id="arrow">
            <img id="compare-txt" src="https://res.cloudinary.com/dtbjhs8a6/image/upload/v1571193103/samples/figma%20career-list/lario/hyu5pvtsmqxymfx5ohwi.png">
        </div>

        <div class="add-text add-text2" id="text-2">
            <label for="text" class="two-text">
                <div class="labels">
                    <img class="white-txt" src="https://res.cloudinary.com/dtbjhs8a6/image/upload/v1571194266/samples/figma%20career-list/lario/ct8pi1qsjgonxsa7zdyn.png">
                    <span id="white-txt" class="compare">Text</span>
                </div>
            </label> <br>
            <textarea placeholder="Write your text here" id="input2" class="input-txt"></textarea>
        </div>
    </section>
    <div id="button">
        <button id="compare" type="submit">
            <img class="compare-img" src="https://res.cloudinary.com/dtbjhs8a6/image/upload/v1571193103/samples/figma%20career-list/lario/butfaguuckar9dl0i1ug.png">
            <span class="compare-btn-txt">COMPARE</span>
        </button>
    </div>
    <div id="result"></div>

    
    <script src="https://code.jquery.com/jquery-3.4.1.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>


    <script>
    function csrfSafeMethod(method) {
    // these HTTP methods do not require CSRF protection
    return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
}

function getCookie(name) {
    var cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookie = cookies[i].trim();
            // Does this cookie string begin with the name we want?
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}



    $('#uploadForm').submit(function(e) {
        var csrftoken = jQuery("[name=csrfmiddlewaretoken]").val();
    
          e.preventDefault();
    
          $form = $(this)
          var formData = new FormData(this);
          console.log(formData);
          formData.append('file', $('#upload1')[0].files[0]);
          formData.append('file', $('#upload2')[0].files[0]);
    
    
    
          $.ajax({
            url: "https://docufix.pythonanywhere.com/upload/",
            type: "POST",
            data: formData,
            beforeSend: function(xhr, settings) {
                if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                    xhr.setRequestHeader("X-CSRFToken", csrftoken);
                }
            },
            success: function(response){
                console.log('success');
                console.log(response);
                $('#input1').val(response.file1)
                $('#input2').val(response.file2)
                toastr.success("Content Loaded Successfully");
                
            },
            error: function(){
                toastr.error("An Error Occured");
                console.log("Error Occured");
                
            },
            cache: false,
            contentType: false,
            processData: false
            
        })
    })
        
       
    
    $('#compare').on('click', function (e) {
    e.preventDefault()
     let separators = [' ', '\\\+', '-', '\\\(', '\\\)','\\*', '/', '\\\.', '\\\?'];
    let firstString = $('#input1').val()
    let secondString = $('#input2').val()
    let firstStringSet = new Set(firstString.split(new RegExp(separators.join('|'), 'g')))
    let secondStringSet = new Set(secondString.split(new RegExp(separators.join('|'), 'g')))

    console.log(secondStringSet);
    

    let firstStringArray = firstString.split(new RegExp(separators.join('|'), 'g'))
    console.log(firstStringArray);
    
    let secondStringArray = secondString.split(new RegExp(separators.join('|'), 'g'))
    $('#result').html(' ')
        
    secondStringSet.forEach( word => {

        let resultA = firstStringArray.filter(newWord => newWord === word  );
        let resultB = secondStringArray.filter( newWord => newWord === word );
        if (resultB != 0 && resultA != 0 ){
        console.log( `${word} appeared in First document ${resultA.length} time and it appeared in Second document ${resultB.length} times`);
      
      
        $('#result').append(
            
            `${word} appeared in First document ${resultA.length} time and it appeared in Second document ${resultB.length} times <br>`)
    
    }
    

  
    });
  

    

})








    
    </script>
</body>
</html>

